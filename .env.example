# Surreal Mind MCP Server - Environment Configuration
# Copy this file to .env and fill in your values

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# SurrealDB connection URL (WebSocket for main connection, HTTP derived for SQL queries)
# Default: 127.0.0.1:8000 (for local SurrealDB instance)
# For remote/production: wss://your-db.example.com:8000
SURR_DB_URL=127.0.0.1:8000

# Database credentials (used for HTTP Basic Auth on SQL queries)
# Default: root (common for development; change for production)
SURR_DB_USER=root
SURR_DB_PASS=root

# SurrealDB namespace and database name
# Default: surreal_mind and consciousness
SURR_DB_NS=surreal_mind
SURR_DB_DB=consciousness

# Maximum number of results to fetch from DB in single query
# Default: 500 (range: 50-5000)
SURR_DB_LIMIT=500

# =============================================================================
# EMBEDDING PROVIDER CONFIGURATION
# =============================================================================

# Embedding provider: openai (primary) or candle (local dev fallback)
# No fake/deterministic or Nomic providers supported
SURR_EMBED_PROVIDER=openai

# OpenAI API key (required if SURR_EMBED_PROVIDER=openai)
# Get from: https://platform.openai.com/api-keys
OPENAI_API_KEY=your-openai-api-key-here

# Candle (BGE) runs locally; no API key needed.
# When SURR_EMBED_PROVIDER=candle, SURR_EMBED_MODEL should be bge-small-en-v1.5 and SURR_EMBED_DIM=384.

# OpenAI embedding model
# Options: text-embedding-3-small (1536 dims), text-embedding-3-large (3072 dims)
# Default: text-embedding-3-small
SURR_EMBED_MODEL=text-embedding-3-small

# Override embedding dimensions (optional)
# For OpenAI text-embedding-3-small: 1536
# For Candle BGE-small-en-v1.5: 384
# Default: Use provider's default dimensions
# SURR_EMBED_DIM=1536

# Require explicit provider configuration; error if none available
# Default: false (Candle local fallback if OPENAI_API_KEY is unset)
SURR_EMBED_STRICT=false

# Number of retries for embedding API calls
# Default: 3 (max: 5)
SURR_EMBED_RETRIES=3

# Delay between retry attempts in ms (exponential backoff base)
# Default: 500
SURR_RETRY_DELAY_MS=500

# =============================================================================
# CACHE AND PERFORMANCE TUNING
# =============================================================================

# Maximum entries in in-memory LRU cache
# Default: 5000 (increase for more memory if needed)
SURR_CACHE_MAX=5000

# Batch size for warming the cache on DB fallback
# Default: 64 (max: 1000)
SURR_CACHE_WARM=64

# Maximum candidates to retrieve from DB for similarity search
# Default: Same as SURR_DB_LIMIT (50-5000)
SURR_RETRIEVE_CANDIDATES=500

# =============================================================================
# RETRIEVAL AND SEARCH TUNING
# =============================================================================

# Default similarity threshold for search (0.0-1.0)
# Default: 0.5
SURR_SIM_THRESH=0.5

# Default top-k results for search
# Default: 5
SURR_TOP_K=5

# =============================================================================
# TOOL AND OPERATION TIMEOUTS
# =============================================================================

# Timeout per tool call in ms
# Default: 15000 (15 seconds)
SURR_TOOL_TIMEOUT_MS=15000

# WebSocket query timeout in ms
# Default: 10000 (10 seconds)
SURR_DB_TIMEOUT_MS=10000

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log level (Rust tracing format)
# Default: surreal_mind=info,rmcp=info
RUST_LOG=surreal_mind=info,rmcp=info

# Disable MCP-specific logs to stderr (for JSON-only environments)
# Default: false (logs enabled)
MCP_NO_LOG=false

# =============================================================================
# TESTING AND DEVELOPMENT
# =============================================================================

# Fake/deterministic embedders are NOT supported. Do not enable any fake embedding flags.

# Run database integration tests (env var presence enables)
# Default: not set (tests skipped)
# RUN_DB_TESTS=1

# Enable database integration feature for tests
# Default: not set
# SURR_DB_INTEGRATION=true

# =============================================================================
# ADVANCED CONFIGURATION (OPTIONAL)
# =============================================================================

# Config file path (TOML format, if using file-based config)
# Default: surreal_mind.toml
SURREAL_MIND_CONFIG=surreal_mind.toml

# Force serialization of DB queries to prevent deadlocks
# Default: false (enable if experiencing WebSocket issues)
# SURR_DB_SERIAL=false

# Enable submode-aware retrieval (adjusts weights by submode)
# Default: false
# SURR_SUBMODE_RETRIEVAL=false

# Default submode when not specified
# Default: sarcastic
# SURR_SUBMODE_DEFAULT=sarcastic

# =============================================================================
# KNOWLEDGE GRAPH TUNING (ADVANCED)
# =============================================================================

# Embed entities in KG creation
# Default: true
SURR_KG_EMBED_ENTITIES=true

# Embed observations in KG creation
# Default: true
SURR_KG_EMBED_OBSERVATIONS=true

# Maximum neighbors per node in KG search
# Default: 25
SURR_KG_MAX_NEIGHBORS=25

# Boost for graph neighbors in search scoring
# Default: 0.15
SURR_KG_GRAPH_BOOST=0.15

# Minimum edge strength for graph expansion
# Default: 0.0 (include all edges)
SURR_KG_MIN_EDGE_STRENGTH=0.0

# Timeout for KG operations in ms
# Default: 5000
SURR_KG_TIMEOUT_MS=5000

# Maximum candidates for KG expansion
# Default: Uses SURR_RETRIEVE_CANDIDATES
# SURR_KG_CANDIDATES=500

# =============================================================================
# LEGACY/DEPRECATED (MAY BE REMOVED IN FUTURE)
# =============================================================================

# Fallback search-specific top-k (now uses SURR_TOP_K)
# SURR_SEARCH_TOP_K=10

# Fallback search-specific sim thresh (now uses SURR_SIM_THRESH)
# SURR_SEARCH_SIM_THRESH=0.5

# DB max concurrency (for batch operations)
# SURR_DB_MAX_CONCURRENCY=1

# Operation timeout for retries
# SURR_OPERATION_TIMEOUT_MS=5000
