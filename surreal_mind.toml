# Zed System Configuration
# All parameters migrated from environment variables and function parameters
# Enables simplified think(content, mode) API

[system]
embedding_provider = "openai"
embedding_model = "text-embedding-3-small"
embedding_dimensions = 1536
embed_retries = 3
database_url = "ws://127.0.0.1:8000"
database_ns = "surreal_mind"
database_db = "consciousness"
inject_debounce = 1000
gemini_model = "gemini-3-pro-preview"

[retrieval]
# Core retrieval settings
max_injection_scale = 3
default_injection_scale = 1
kg_only = true  # New: only pull from KG, not thoughts
similarity_threshold = 0.5
top_k = 5
# Required by older stable build (2fb3ec1)
kg_moderation_threshold = 0.6
# Thresholds for memory injection scales and floor (required)
t1 = 0.6
t2 = 0.4
t3 = 0.25
floor = 0.15
# Performance and limits
db_limit = 100  # For SURR_DB_LIMIT
candidates = 20  # For SURR_RETRIEVE_CANDIDATES
submode_tuning = true  # For SURR_SUBMODE_RETRIEVAL

[orbital_mechanics]
# How entities drift in the KG over time
decay_rate = 0.1  # Per day - how much significance decays
access_boost = 0.2  # Per access - significance boost on retrieval
significance_weight = 0.3  # Base weight for stored significance
recency_weight = 0.4  # Weight for temporal recency
access_weight = 0.3  # Weight for access frequency

# Submode configurations - different "orbits" for different thinking styles

[submodes.plan]
# Mars orbit - maximum context, strategic planning
injection_scale = 3
significance = 0.8
kg_traverse_depth = 2
frameworks = { SystemsThinking = 0.6, FirstPrinciples = 0.4 }
orbital_weights = { recency = 0.2, access = 0.3, significance = 0.5 }
auto_extract = true
edge_boosts = { depends_on = 1.5, blocks = 1.3, relates_to = 1.1 }

[submodes.build]
# Mercury orbit - focused implementation, minimal distraction
injection_scale = 1
significance = 0.5
kg_traverse_depth = 1
frameworks = { OODA = 0.8, Lateral = 0.2 }
orbital_weights = { recency = 0.7, access = 0.2, significance = 0.1 }
auto_extract = false  # Don't pollute KG while building
edge_boosts = { implements = 1.5, uses = 1.3 }

[submodes.debug]
# Mercury orbit - current issue focus with diagnostic frameworks
injection_scale = 1
significance = 0.9  # Debug thoughts are highly significant
kg_traverse_depth = 1
frameworks = { RootCause = 0.7, OODA = 0.3 }
orbital_weights = { recency = 0.8, access = 0.1, significance = 0.1 }
auto_extract = true
edge_boosts = { causes = 2.0, fixes = 1.8, related_to = 1.2 }

[submodes.sarcastic]
# Venus orbit - contextual awareness for callbacks and references
injection_scale = 2
significance = 0.6
kg_traverse_depth = 1
frameworks = { Socratic = 0.6, OODA = 0.3, Lateral = 0.1 }
orbital_weights = { recency = 0.5, access = 0.3, significance = 0.2 }
auto_extract = true
edge_boosts = { mocks = 1.5, references = 1.3 }

[submodes.empathetic]
# Venus orbit - emotional context and relational awareness
injection_scale = 2
significance = 0.7
kg_traverse_depth = 1
frameworks = { Socratic = 0.8, Lateral = 0.2 }
orbital_weights = { recency = 0.4, access = 0.2, significance = 0.4 }
auto_extract = true
edge_boosts = { relates_to = 1.5, supports = 1.3 }

[submodes.philosophical]
# Mars orbit - deep connection chains and conceptual frameworks
injection_scale = 3
significance = 0.9
kg_traverse_depth = 3  # Follow deep conceptual chains
frameworks = { FirstPrinciples = 0.5, SystemsThinking = 0.3, Dialectical = 0.2 }
orbital_weights = { recency = 0.1, access = 0.2, significance = 0.7 }
auto_extract = true
edge_boosts = { implies = 1.8, contradicts = 1.6, relates_to = 1.2 }

[submodes.problem_solving]
# Venus orbit - balanced analysis with multiple frameworks
injection_scale = 2
significance = 0.7
kg_traverse_depth = 2
frameworks = { RootCause = 0.4, SystemsThinking = 0.3, OODA = 0.3 }
orbital_weights = { recency = 0.4, access = 0.3, significance = 0.3 }
auto_extract = true
edge_boosts = { solves = 2.0, blocks = 1.5, depends_on = 1.3 }

[submodes.default]
# Earth orbit - standard operational parameters
injection_scale = 1
significance = 0.5
kg_traverse_depth = 1
frameworks = { Socratic = 0.5, OODA = 0.5 }
orbital_weights = { recency = 0.4, access = 0.3, significance = 0.3 }
auto_extract = true
edge_boosts = { relates_to = 1.1 }
match_threshold = 0.5

[memory_injection]
# Required by older stable build (2fb3ec1)
inject_debounce_ms = 1000
similarity_threshold = 0.6
# Floor for memory injection (required)
floor = 0.15
# Thresholds for injection scales 1-3 (required)
t1 = 0.6
t2 = 0.4
t3 = 0.25

[maintenance]
# Cleanup configuration
dry_run = false  # For SURR_MAINTENANCE_DRY_RUN
format = "parquet"  # For SURR_MAINTENANCE_FORMAT
limit = 100  # For SURR_MAINTENANCE_LIMIT
output_dir = "./archive"  # For SURR_MAINTENANCE_OUTPUT_DIR
retention_days = 365  # Keep memories for 1 year
deletion_batch_size = 100  # Delete in batches of 100

[logging]
# Logging behavior
level = "info"  # Default log level
deep_log = false  # For SURR_THINK_DEEP_LOG
mcp_no_log = false  # For MCP_NO_LOG (disable logs in stdio mode)
json_errors = true  # Format errors as JSON for MCP compatibility

[http]
# HTTP fallback configuration
port = 3000  # Port for HTTP interface
cors = true  # Enable CORS
timeout_ms = 30000  # Request timeout
user_agent = "LegacyMind-Surreal/0.1.0"
strict_security = true  # Enforce HTTPS/Auth in production
rate_limit = 100  # Requests per minute
max_body_size = 1048576  # 1MB max payload
trace_requests = true  # Log all requests
trace_headers = ["User-Agent", "X-Request-ID"]  # Headers to log
trace_bodies = false  # Don't log request bodies by default
trace_responses = false  # Don't log response bodies by default
trace_errors = true  # Log all errors
trace_performance = true  # Log timing data
trace_auth = false  # Don't log auth details
trace_payloads = false  # Don't log payloads
trace_queries = false  # Don't log raw queries
trace_stacks = false  # Don't include stack traces in logs

[testing]
# Test environment settings
test_db_ns = "test_mind"
test_db_db = "test_consciousness"
mock_embeddings = true  # Use deterministic embeddings for tests
verbose_failures = true  # Show full details on test failure
snapshot_dir = "tests/snapshots"  # Directory for test snapshots
fixture_dir = "tests/fixtures"  # Directory for test fixtures
timeout_ms = 5000  # Default test timeout
parallel = true  # Run tests in parallel where possible
db_cleanup = true  # Clean up test DB after run
db_isolation = true  # Run each test in isolated DB scope